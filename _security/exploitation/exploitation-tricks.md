---
title:  "Some exploitation tricks"
topic: "exploitation"
---

* [Custom tools](https://github.com/greglan/sec-tools)
* View instructions encoding of binary: `objdump -D -b binary -m i386 -M intel filename.bin`
* Memory map in file: `/proc/$PID/maps`

# Exploitation outside of a debugger
* Have exactly the same environment variables, otherwise the stack is shifted
* Start the debugger and program using the absolute path
* [Test if a payload contains filtered bytes](https://github.com/greglan/sec-tools/blob/master/check_bad_bytes.py)
* [Privilege drop](https://archive.cert.uni-stuttgart.de/vuln-dev/2003/03/msg00024.html)
* Check the stack flags: `readelf -l prog_name | grep GNU_STACK`
* Get addresses of buffers: `ltrace prog_name`
* Keep stdin open: `(cat /tmp/payload;cat) | `
* [Why SUID Binary exploit does not yield root shell](https://archive.cert.uni-stuttgart.de/vuln-dev/2003/03/msg00024.html)
* [StackOverflow on exploitation outside GDB](https://stackoverflow.com/questions/17775186/buffer-overflow-works-in-gdb-but-not-without-it/17775966#17775966)

# Compilation flags
## Gcc
* Enable GDB debugging symbols: `-ggdb`
* Compile for 32bit systems: `-m32`
* Disable stack smashing protection: `-fno-stack-protector`
* Allow stack execution: `-z execstack`

## Others
* Force 32 bits executables (LD): `-m elf_i386`


# Resources and references
* [Hackndo](https://beta.hackndo.com/archives/)
* [Bios wiki](https://teambi0s.gitlab.io/bi0s-wiki/)
* [Hyper-V fuzzing](https://labs.mwrinfosecurity.com/blog/ventures-into-hyper-v-part-1-fuzzing-hypercalls)
* [Insecure programming by example](https://web.archive.org/web/20120401214722/http://community.coresecurity.com/~gera/InsecureProgramming/)
* [Binding TCP shellcode](https://reboare.github.io/slae/slae1.html)
* [Virgil](https://booj.gitbook.io/virgil/)
* [Frame pointer overwrite](http://phrack.org/issues/55/8.html)
* [Smashign the stack for fun and profit](http://phrack.org/issues/49/14.html)
